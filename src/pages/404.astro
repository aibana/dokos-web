---
import BaseLayout from '../layouts/BaseLayout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
import DownloadModal from '../components/DownloadModal.astro';
import Icon from '../components/Icon.astro';
import { getTranslations, defaultLocale } from '../i18n/utils';

const locale = defaultLocale;
const t = getTranslations(locale);
---

<BaseLayout locale={locale} t={t}>
  <Navbar slot="navbar" t={t} locale={locale} />

  <section class="relative min-h-screen flex items-center justify-center overflow-hidden hero-mesh" aria-labelledby="not-found-heading">
    <!-- Ambient orbs -->
    <div id="hero-orbs" class="absolute inset-0 pointer-events-none z-0 overflow-hidden" aria-hidden="true">
      <div class="orb orb-1"></div>
      <div class="orb orb-2"></div>
      <div class="orb orb-3"></div>
      <div class="orb orb-4"></div>
      <div class="orb orb-5"></div>
    </div>

    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center">
      <!-- Error code -->
      <p class="text-8xl sm:text-9xl font-black text-transparent bg-clip-text bg-gradient-to-r from-primary to-accent-neon mb-4 leading-none select-none" aria-hidden="true">
        404
      </p>

      <h1 id="not-found-heading" class="text-3xl sm:text-4xl font-extrabold tracking-tight text-slate-100 mb-4">
        {t.notFound.title}
      </h1>

      <p class="text-lg text-slate-400 mb-10 leading-relaxed max-w-xl mx-auto">
        {t.notFound.subtitle}
      </p>

      <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
        <a
          href="/"
          class="inline-flex items-center justify-center gap-2 px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-primary hover:bg-primary-dark shadow-lg shadow-primary/25 transition-all"
        >
          <Icon name="arrow_back" />
          {t.notFound.goHome}
        </a>

        <button
          id="not-found-download-btn"
          class="inline-flex items-center justify-center gap-2 px-6 py-3 border border-slate-700 text-base font-medium rounded-lg text-slate-200 bg-surface-dark hover:bg-slate-800 transition-all cursor-pointer"
        >
          <Icon name="download" />
          {t.common.downloadForFree}
        </button>
      </div>
    </div>
  </section>

  <DownloadModal t={t} />

  <Footer slot="footer" t={t} locale={locale} />
</BaseLayout>

<style>
  .orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(20px);
    will-change: transform;
  }

  .orb-1 {
    width: 400px;
    height: 400px;
    background: rgba(19, 91, 236, 0.08);
    top: 10%;
    left: -5%;
    animation: drift-1 25s ease-in-out infinite;
  }

  .orb-2 {
    width: 350px;
    height: 350px;
    background: rgba(16, 185, 129, 0.06);
    top: 40%;
    right: -8%;
    animation: drift-2 30s ease-in-out infinite;
  }

  .orb-3 {
    width: 300px;
    height: 300px;
    background: rgba(19, 91, 236, 0.05);
    bottom: 15%;
    left: 30%;
    animation: drift-3 22s ease-in-out infinite;
  }

  .orb-4 {
    width: 250px;
    height: 250px;
    background: rgba(139, 92, 246, 0.06);
    top: 60%;
    left: 10%;
    animation: drift-4 28s ease-in-out infinite;
  }

  .orb-5 {
    width: 320px;
    height: 320px;
    background: rgba(16, 185, 129, 0.05);
    top: 5%;
    right: 20%;
    animation: drift-5 35s ease-in-out infinite;
  }

  @keyframes drift-1 {
    0%, 100% { transform: translate(0, 0) scale(1); }
    25% { transform: translate(80px, 60px) scale(1.1); }
    50% { transform: translate(40px, 120px) scale(0.95); }
    75% { transform: translate(-30px, 50px) scale(1.05); }
  }

  @keyframes drift-2 {
    0%, 100% { transform: translate(0, 0) scale(1); }
    25% { transform: translate(-70px, -40px) scale(1.08); }
    50% { transform: translate(-100px, 30px) scale(0.92); }
    75% { transform: translate(-40px, -80px) scale(1.03); }
  }

  @keyframes drift-3 {
    0%, 100% { transform: translate(0, 0) scale(1); }
    33% { transform: translate(60px, -50px) scale(1.12); }
    66% { transform: translate(-50px, -30px) scale(0.9); }
  }

  @keyframes drift-4 {
    0%, 100% { transform: translate(0, 0) scale(1); }
    20% { transform: translate(50px, -70px) scale(1.06); }
    50% { transform: translate(90px, -30px) scale(0.94); }
    80% { transform: translate(30px, 40px) scale(1.1); }
  }

  @keyframes drift-5 {
    0%, 100% { transform: translate(0, 0) scale(1); }
    30% { transform: translate(-60px, 80px) scale(1.08); }
    60% { transform: translate(40px, 50px) scale(0.93); }
    80% { transform: translate(-20px, 100px) scale(1.05); }
  }
</style>

<script>
  document.getElementById('not-found-download-btn')?.addEventListener('click', () => {
    const fn = (window as any).openDownloadModal;
    if (typeof fn === 'function') fn();
  });

  const orbs = document.getElementById('hero-orbs');
  if (orbs) {
    const obs = new IntersectionObserver(([entry]) => {
      for (const child of orbs.children) {
        (child as HTMLElement).style.animationPlayState = entry.isIntersecting ? 'running' : 'paused';
      }
    });
    obs.observe(orbs);
  }
</script>
